function SceneManager(programInst)
  local self = {}
    
  local currentScene = nil
  local program = programInst
  
  self.setScene = function(newScene, animation)
    if newScene == nil then return end
  
    Logger.log("SceneManager: Set scene "..newScene.getTag())
    if currentScene ~= newScene then
      if currentScene then
        currentScene.active = false
        
        if currentScene.onStop then
          Logger.log("SceneManager: Stop scene "..currentScene.getTag())
          currentScene.onStop(program)
        end
      end
      currentScene = newScene
      if currentScene ~= nil then
        currentScene.active = true
        
        if not animation then
          program:LoadView(currentScene.getViewName())
          currentScene.view = program.View
          
          if currentScene.onStart then
            currentScene.onStart(program)
          end
          
          if self.onSceneChange then
            self.onSceneChange(currentScene)
          end
        else
          animation.animate()
          animation.onAnimationEnd = function() 
            program:LoadView(currentScene.getViewName())
            currentScene.view = program.View 
            
            if currentScene.onStart then
              currentScene.onStart(program)
            end
            
            if self.onSceneChange then
              self.onSceneChange(currentScene)
            end
          end
        end
      end
    end
  end
  
  self.getScene = function()
    return currentScene
  end
  
  return self
end