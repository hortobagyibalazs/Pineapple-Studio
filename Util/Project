function Project(_path, _name, _singleFile)
  local self = {}
  
  local name = _name
  local path = _path
  local singleFileProject = _singleFile
  local projectTree = {}  
  local listeners = {}
  
  local projectSettings = SharedPreferences()
  projectSettings.getFilePath = function()
    return self.getProjectFile()
  end
  
  self.getName = function()
    return name
  end
  
  self.getPath = function()
    return path
  end
  
  self.getProjectDir = function()
    return path.."/"..name
  end
  
  self.getProjectFile = function()
    local file = nil
    
    for k, v in pairs(projectTree) do
      if v["Type"] == "File" and v["Name"]:sub(-4) == "."..PROJECT_FILE_EXT then
        file = v["Path"].."/"..v["Name"]
      end
    end
    return file
  end
  
  self.getProjectTree = function()
    return projectTree
  end
  
  self.exists = function()
    return fs.exists(self.getProjectDir())
  end
  
  self.refreshProjectTree = function()  
    local function scanDir(path)
      local fileTree = {}
      if fs.isDir(path) then
        for k, v in pairs(fs.list(path)) do
          if fs.isDir(path.."/"..v) then
            local dir = {Name = v, Type = "Folder", Path = path, Children = {}}
            dir.Children = scanDir(path.."/"..v)
            table.insert(fileTree, dir)
          else
            table.insert(fileTree, {Name = v, Type = "File", Path = path})
          end
        end
      else
        return {Name = fs.getName(path), Type = "File"}
      end
      
      return fileTree
    end
  
    projectTree = scanDir(self.getProjectDir())
    
    if self.onProjectTreeRefresh then
      self.onProjectTreeRefresh()
    end
    Logger.log("Project: Refreshed project tree for "..self.getProjectDir())
    
    for k, v in pairs(listeners) do
      v()
    end
    
    return projectTree
  end
  
  self.addOnFileTreeChangeListener = function(listener) 
    table.insert(listeners, listener)
  end
  
  self.removeOnFileTreeChangeListener = function(listener)
    table.remove(listeners, listener)
  end
  
  self.removeOnFileTreeChangeListeners = function()
    listeners = {}
  end
  
  self.singleFile = function()
    return singleFileProject
  end
  
  self.getProjectSettings = function()
    return projectSettings
  end
  
  return self
end